ekf_filter_node:
  ros__parameters:

    # ==================================================
    # General
    # ==================================================
    frequency: 30.0
    sensor_timeout: 0.2
    two_d_mode: true

    publish_tf: true
    publish_acceleration: false

    world_frame: odom
    odom_frame: odom
    base_link_frame: base_link

    # ==================================================
    # Wheel Odometry (PRIMARY for x, y, yaw-rate)
    # ==================================================
    odom0: /wheel/odometry
    odom0_config: [
      true,  true,  false,    # x, y, z
      false, false, true,     # roll, pitch, yaw
      false, false, false,    # vx, vy, vz
      false, false, false,    # vroll, vpitch, vyaw
      false, false, false     # ax, ay, az
    ]

    odom0_differential: false
    odom0_relative: false
    odom0_queue_size: 10

    # ==================================================
    # IMU (USE YAW ONLY)
    # ==================================================
    imu0: /imu/data
    imu0_config: [
      false, false, false,    # x, y, z
      false, false, true,     # roll, pitch, yaw
      false, false, false,    # vx, vy, vz
      false, false, false,    # vroll, vpitch, vyaw
      false, false, false     # ax, ay, az
    ]

    imu0_differential: true
    imu0_relative: false
    imu0_queue_size: 10
    imu0_remove_gravitational_acceleration: false

    # ==================================================
    # Process Noise Covariance (ALL FLOATS)
    # Order:
    # [x, y, z,
    #  roll, pitch, yaw,
    #  vx, vy, vz,
    #  vroll, vpitch, vyaw,
    #  ax, ay, az]
    # ==================================================
    process_noise_covariance: [
      0.05,  0.0,   0.0,    0.0,    0.0,    0.0,
      0.0,   0.05,  0.0,    0.0,    0.0,    0.0,
      0.0,   0.0,   1000.0, 0.0,    0.0,    0.0,
      0.0,   0.0,   0.0,    1000.0, 0.0,    0.0,
      0.0,   0.0,   0.0,    0.0,    1000.0, 0.0,
      0.0,   0.0,   0.0,    0.0,    0.0,    0.1
    ]

    # ==================================================
    # Initial State (สำคัญมาก)
    # ==================================================
    initial_state:
      x: 0.0
      y: 0.0
      yaw: 0.0
